(function(){var scriptUrl='https://script.google.com/macros/s/AKfycbwc3NZM66LYweTHVRGMvWCHKyRgINYFtzvm2K5u6aE8bLarCbovJuzZTW0lQS0x0pYe0w/exec';fetch(scriptUrl).then(function(response){if(!response.ok){throw new Error('Network response was not ok.')};return response.json()}).then(function(record){var moviesT=document.querySelector('.moviesT');if(!moviesT)return;var detailsDiv=moviesT.querySelector('#details');var boxOfficeEl=document.querySelector('.boxOffice');if(!detailsDiv||detailsDiv.getAttribute('data-fetch-id')!==record.postID){if(boxOfficeEl){boxOfficeEl.classList.add('hidden')};return}else{if(boxOfficeEl){boxOfficeEl.classList.remove('hidden');var pSLEl=boxOfficeEl.querySelector('.pSL');if(pSLEl){pSLEl.classList.remove('hidden')}}};var netCollections=record.netCollections.slice();netCollections.sort(function(a,b){var dayA=parseInt(a.name.replace('Day','').trim(),10);var dayB=parseInt(b.name.replace('Day','').trim(),10);return dayA-dayB});var table=document.createElement('table');table.className='tableBox';var tbody=document.createElement('tbody');tbody.innerHTML='<tr><th>Day</th><th>India Net Collection</th><th>Change(+/-)</th></tr>';var weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var releaseIndex=weekdays.indexOf(record.releaseDay);if(releaseIndex===-1){releaseIndex=0};function ordinal(n){var s=["th","st","nd","rd"],v=n%100;return n+(s[(v-20)%10]||s[v]||s[0])};var weekSum=0;var weekCount=0;var prevWeekTotal=0;var weekendGroups=[];var currentWeekendTotal=null;var currentWeekendDays=[];for(var i=0;i<netCollections.length;i++){var current=netCollections[i];var currentVal=parseFloat(current.nettC);weekSum+=currentVal;var weekdayIndex=(releaseIndex+i)%7;var dayWeek=weekdays[weekdayIndex];var isWeekend=(weekdayIndex===5||weekdayIndex===6||weekdayIndex===0);if(isWeekend){if(currentWeekendTotal===null){currentWeekendTotal=currentVal;currentWeekendDays=[weekdayIndex]}else{currentWeekendTotal+=currentVal;currentWeekendDays.push(weekdayIndex)}}else{if(currentWeekendTotal!==null){if(currentWeekendDays.includes(0)){weekendGroups.push(currentWeekendTotal)};currentWeekendTotal=null;currentWeekendDays=[]}};var dayNumber=i+1;var weekNumForDay=Math.floor(i/7)+1;var dayLabel='Day '+dayNumber+' ['+ordinal(weekNumForDay)+' '+dayWeek+']';var changeText='NA';var changeClass='noT';if(i>0){var prevVal=parseFloat(netCollections[i-1].nettC);var change=((currentVal-prevVal)/prevVal)*100;changeText=change.toFixed(2)+'%';changeClass=change>0?'addT':(change<0?'subT':'noT')};var dayRow=document.createElement('tr');dayRow.innerHTML='<td>'+dayLabel+'</td>'+'<td>₹ '+current.nettC+' Cr</td>'+'<td class="'+changeClass+'">'+changeText+'</td>';tbody.appendChild(dayRow);if((i+1)%7===0){weekCount++;var weekChange='NA';var weekChangeClass='noT';if(weekCount>1&&prevWeekTotal!==0){var wchg=((weekSum-prevWeekTotal)/prevWeekTotal)*100;weekChange=(wchg>0?'+':'')+wchg.toFixed(2)+'%';weekChangeClass=wchg>0?'addT':(wchg<0?'subT':'noT')};var weekRow=document.createElement('tr');weekRow.classList.add('weekUp');weekRow.innerHTML='<td class="weekT">Week '+weekCount+' Collection</td>'+'<td class="weekT boxC">₹ '+weekSum.toFixed(2)+' Cr</td>'+'<td class="'+weekChangeClass+'">'+weekChange+'</td>';tbody.appendChild(weekRow);prevWeekTotal=weekSum;weekSum=0}};if(currentWeekendTotal!==null&&currentWeekendDays.includes(0)){weekendGroups.push(currentWeekendTotal)};var totalNet=netCollections.reduce(function(sum,item){return sum+parseFloat(item.nettC)},0);var totalRow=document.createElement('tr');totalRow.className='bTbx';totalRow.innerHTML='<td>Net Collection</td>'+'<td colspan="2">₹ '+totalNet.toFixed(2)+' Cr</td>';tbody.appendChild(totalRow);table.appendChild(tbody);var boxColl=document.querySelector('.boxColl');if(boxColl){boxColl.innerHTML='';boxColl.appendChild(table)};if(weekendGroups.length>0){var weekendTable=document.createElement('table');weekendTable.className='tableBox weekND';var weekendTbody=document.createElement('tbody');weekendTbody.innerHTML='<tr><th>Weekend</th><th>Collections</th><th>Change(+/-)</th></tr>';var previousWeekend=null;weekendGroups.forEach(function(total,idx){var changeText='NA';var changeClass='noT';if(previousWeekend!==null&&previousWeekend!==0){var change=((total-previousWeekend)/previousWeekend)*100;changeText=(change>0?'+':'')+change.toFixed(2)+'%';changeClass=change>0?'addT':(change<0?'subT':'noT')};var row=document.createElement('tr');row.innerHTML='<td>Weekend '+(idx+1)+'</td>'+'<td>₹ '+total.toFixed(2)+' Cr</td>'+'<td class="'+changeClass+'">'+changeText+'</td>';weekendTbody.appendChild(row);previousWeekend=total});weekendTable.appendChild(weekendTbody);if(boxColl)boxColl.appendChild(weekendTable);};var chartContainer=document.querySelector('.box-line-chart');if(chartContainer){chartContainer.innerHTML='';var svgWidth=chartContainer.offsetWidth;var svgHeight=400;var margin={top:20,right:20,bottom:40,left:50},width=svgWidth-margin.left-margin.right,height=svgHeight-margin.top-margin.bottom;var svgNS="http://www.w3.org/2000/svg";var svg=document.createElementNS(svgNS,"svg");svg.setAttribute("width",svgWidth);svg.setAttribute("height",svgHeight);svg.style.backgroundColor="#fff";chartContainer.appendChild(svg);var g=document.createElementNS(svgNS,"g");g.setAttribute("transform","translate("+margin.left+","+margin.top+")");svg.appendChild(g);var dataPoints=netCollections.map(function(item,index){return{day:index+1,value:parseFloat(item.nettC)}});var xScale=function(day){return(day-1)*(width/(dataPoints.length-1))};var maxVal=Math.max.apply(null,dataPoints.map(function(d){return d.value}));var maxTick,tickInterval;if(maxVal<=50){maxTick=50;tickInterval=10}else if(maxVal<=80){maxTick=80;tickInterval=15}else if(maxVal<=100){maxTick=100;tickInterval=20}else if(maxVal<=150){maxTick=150;tickInterval=25}else if(maxVal<=200){maxTick=200;tickInterval=30}else{tickInterval=Math.ceil(maxVal/7);maxTick=tickInterval*7};var yScale=function(value){return height-(value/maxTick)*height};var xAxis=document.createElementNS(svgNS,"line");xAxis.setAttribute("x1",0);xAxis.setAttribute("y1",height);xAxis.setAttribute("x2",width);xAxis.setAttribute("y2",height);xAxis.setAttribute("stroke","#000");g.appendChild(xAxis);var yAxis=document.createElementNS(svgNS,"line");yAxis.setAttribute("x1",0);yAxis.setAttribute("y1",0);yAxis.setAttribute("x2",0);yAxis.setAttribute("y2",height);yAxis.setAttribute("stroke","#000");g.appendChild(yAxis);var xLabel=document.createElementNS(svgNS,"text");xLabel.setAttribute("x",width/2);xLabel.setAttribute("y",height+margin.bottom-5);xLabel.setAttribute("text-anchor","middle");xLabel.setAttribute("font-size","12px");xLabel.textContent="Days";g.appendChild(xLabel);var yLabel=document.createElementNS(svgNS,"text");yLabel.setAttribute("text-anchor","middle");yLabel.setAttribute("font-size","12px");yLabel.setAttribute("transform","translate("+(-margin.left+15)+","+(height/2)+") rotate(-90)");yLabel.textContent="Money";g.appendChild(yLabel);var linePath=document.createElementNS(svgNS,"polyline");var points=dataPoints.map(function(d){return xScale(d.day)+","+yScale(d.value)}).join(" ");linePath.setAttribute("points",points);linePath.setAttribute("fill","none");linePath.setAttribute("stroke","#f97316");linePath.setAttribute("stroke-width","2");g.appendChild(linePath);var labelDays=[1,5,10,15,20,25,30,35,40,45,50];labelDays.forEach(function(day){if(day<=dataPoints.length){var x=xScale(day);var xTick=document.createElementNS(svgNS,"line");xTick.setAttribute("x1",x);xTick.setAttribute("y1",height);xTick.setAttribute("x2",x);xTick.setAttribute("y2",height+5);xTick.setAttribute("stroke","#000");g.appendChild(xTick);var xTickLabel=document.createElementNS(svgNS,"text");xTickLabel.setAttribute("x",x);xTickLabel.setAttribute("y",height+18);xTickLabel.setAttribute("text-anchor","middle");xTickLabel.setAttribute("font-size","10px");xTickLabel.textContent=day;g.appendChild(xTickLabel)}});for(var tickVal=0;tickVal<=maxTick;tickVal+=tickInterval){var y=height-(tickVal/maxTick)*height;var yTick=document.createElementNS(svgNS,"line");yTick.setAttribute("x1",-5);yTick.setAttribute("y1",y);yTick.setAttribute("x2",0);yTick.setAttribute("y2",y);yTick.setAttribute("stroke","#000");g.appendChild(yTick);var yTickLabel=document.createElementNS(svgNS,"text");yTickLabel.setAttribute("x",-10);yTickLabel.setAttribute("y",y+4);yTickLabel.setAttribute("text-anchor","end");yTickLabel.setAttribute("font-size","10px");yTickLabel.textContent=tickVal;g.appendChild(yTickLabel)};const container=document.querySelector(".box-line-chart");const tooltip=document.createElement("div");tooltip.style.position="absolute";tooltip.style.background="rgba(0,0,0,0.7)";tooltip.style.color="#fff";tooltip.style.padding="5px";tooltip.style.borderRadius="3px";tooltip.style.fontSize="12px";tooltip.style.pointerEvents="none";tooltip.style.display="none";tooltip.style.transition="opacity 0.2s ease";tooltip.style.opacity="0";tooltip.style.minHeight="auto";tooltip.style.zIndex="1000";tooltip.style.willChange="transform";container.appendChild(tooltip);let hideTimeout=null;let isTouchTooltipVisible=!1;dataPoints.forEach(function(d){const cx=xScale(d.day);const cy=yScale(d.value);const circle=document.createElementNS(svgNS,"circle");circle.setAttribute("cx",cx);circle.setAttribute("cy",cy);circle.setAttribute("r","4");circle.setAttribute("fill","#f97316");g.appendChild(circle);const showTooltip=(evt)=>{clearTimeout(hideTimeout);tooltip.innerHTML="Day "+d.day+": ₹ "+d.value+" Cr";tooltip.style.display="block";tooltip.style.opacity="1";updateTooltipPosition(evt);isTouchTooltipVisible=!0};const hideTooltip=()=>{hideTimeout=setTimeout(()=>{tooltip.style.opacity="0";tooltip.style.display="none";isTouchTooltipVisible=!1},100)};circle.addEventListener("mouseenter",showTooltip);circle.addEventListener("mousemove",updateTooltipPosition);circle.addEventListener("mouseleave",hideTooltip);circle.addEventListener("touchstart",function(evt){evt.preventDefault();if(isTouchTooltipVisible){hideTooltip()}else{showTooltip(evt.touches[0])}});circle.addEventListener("click",function(evt){showTooltip(evt)});function updateTooltipPosition(evt){const tooltipWidth=tooltip.offsetWidth;const tooltipHeight=tooltip.offsetHeight;const containerRect=container.getBoundingClientRect();let left=evt.clientX-containerRect.left+10;let top=evt.clientY-containerRect.top-tooltipHeight-10;if(left+tooltipWidth>container.clientWidth){left=evt.clientX-containerRect.left-tooltipWidth-10};if(top<0){top=evt.clientY-containerRect.top+10};tooltip.style.left=left+"px";tooltip.style.top=top+"px"}})};var rBoxCGraph=document.querySelector('.rBoxCGraph');if(rBoxCGraph){rBoxCGraph.innerHTML='';var canvas=document.createElement('canvas');canvas.width=100;canvas.height=100;rBoxCGraph.appendChild(canvas);var ctx=canvas.getContext('2d');var centerX=canvas.width/2;var centerY=canvas.height/2;var radius=40;var startAngle=-Math.PI/2;var budgetMatch=record.budget.match(/[\d\.]+/);var budgetVal=budgetMatch?parseFloat(budgetMatch[0]):0;var totalNet=netCollections.reduce(function(sum,item){return sum+parseFloat(item.nettC)},0);var percentage=budgetVal>0?(totalNet/budgetVal)*100:0;if(percentage>100){percentage=100};var endAngle=startAngle+(percentage/100)*2*Math.PI;ctx.beginPath();ctx.arc(centerX,centerY,radius,0,2*Math.PI);ctx.strokeStyle='#f1f3f4';ctx.lineWidth=10;ctx.stroke();ctx.beginPath();ctx.arc(centerX,centerY,radius,startAngle,endAngle);ctx.strokeStyle='#f97316';ctx.lineWidth=10;ctx.stroke();ctx.font='16px Arial';ctx.fillStyle='#212121';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText(Math.round(percentage)+'%',centerX,centerY)};function updateSpan(id,value){var span=document.getElementById(id);if(span){span.setAttribute('data-text',value)}};updateSpan('box-budget',record.budget);updateSpan('box-gross',record.gross);updateSpan('box-office-final',record.boxOffice);updateSpan('box-verdict',record.verdict)}).catch(function(error){console.error('Fetch error:',error)})})();
